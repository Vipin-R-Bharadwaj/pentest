import requests

def get_cvss_score(cve_id):
    """
    Fetch the CVSS score for a given CVE ID from the NVD API.
    """
    url = f"https://services.nvd.nist.gov/rest/json/cve/1.0/{cve_id}"
    try:
        response = requests.get(url)
        data = response.json()

        # Check if CVSSv3 data is available, fallback to CVSSv2 otherwise
        if 'impact' in data['result']['CVE_Items'][0]:
            impact = data['result']['CVE_Items'][0]['impact']
            if 'baseMetricV3' in impact:
                return impact['baseMetricV3']['cvssV3']['baseScore']
            elif 'baseMetricV2' in impact:
                return impact['baseMetricV2']['cvssV2']['baseScore']
        return None
    except Exception as e:
        print(f"Error fetching CVSS score for {cve_id}: {e}")
        return None
