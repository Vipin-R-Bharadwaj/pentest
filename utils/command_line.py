import argparse
from utils.constants import scan_tools
from utils.util_functions import is_true

def command_line_help():

    # Define command line arguments
    parser = argparse.ArgumentParser(description='Pentest commandline help')
    parser.add_argument('-f', '--file', help='File with endpoints')
    parser.add_argument('-a', '--all', help='Use all tools to scan the endpoints')
    parser.add_argument('--nmap', help='Use nmap to scan the endpoints')
    parser.add_argument('--nikto', help='Use nikto to scan the endpoints')
    parser.add_argument('--whatweb', help='Use whatweb to scan the endpoints')
    parser.add_argument('--zaproxy', help='Use zaproxy to scan the endpoints')

    # parse command line arguments
    args = parser.parse_args()

    tools = []

    if is_true(args.all):
        tools = scan_tools
    else:
        for arg in vars(args):
            if is_true(getattr(args, arg)):
                tools.append(arg)

    return args.file, tools
